<section class="container order-history-view">
    <div class="order-history-view-detail hidden-print">
        <nav class="nav nav-cat-search">
            <hr />
            <ul>
                <li class="nav-header text-nav">{{order.Type}} Order<span ng-show="order.ExternalID"> ID: </span>{{order.ExternalID}}</li>
                <li class="nav-header print pull-right" ng-click="onPrint()"><i class="fa fa-print" rel="tooltip" title="Print"></i></li>
            </ul>

            <hr />
        </nav>
        <div class="col-collapse col-md-3 col-md-offset-1 col-md-push-8">
            <div class="row">
                <div class="panel panel-default order-history-view-header col-collapse col-sm-5 col-md-12">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            Order Details
                        </h3>
                    </div>
                    <div class="panel-body text-left">
                        <orderhistorydetails></orderhistorydetails>
                    </div>
                </div>

                <div class="panel panel-default order-history-view-footer col-collapse col-sm-5 col-sm-offset-2 col-md-12 col-md-offset-0">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            Order Summary
                        </h3>
                    </div>
                    <div class="panel-body text-left">
                        <orderhistorysummary></orderhistorysummary>
                    </div>
                    <div class="panel-footer" ng-if="order.FromUserID == user.ID">
                        <div class="order-history-view-repeat">
                            <button class="btn btn-primary" ng-click="repeatOrder()">Repeat Order</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-collapse col-md-8 col-md-pull-4 order-history-view-grid">
            <div class="panel panel-primary order-history-view-line-items">
                <div class="panel-heading">
                    <h3 class="panel-title panel-primary">
                        {{order.LineItems.length}} item{{currentOrder.LineItems.length > 1 ? 's' : ''}} in this order
                    </h3>
                </div>
                <div class="panel-body">
                    <lineitemhistorygrid></lineitemhistorygrid>
                </div>
                <div class="panel-footer" ng-if="order.FromUserID == user.ID">
                    <div class="input-group">
                        <input type="text" ng-model="order.FavoriteName" placeholder="Favorite Name" class="form-control"/>
            <span class="input-group-btn">
                    <!--- TODO the name does not appear to be saving ? --->
                <button type="button" ng-click="saveFavorite()" class="btn btn-default">Save as Favorite</button>
            </span>
                    </div>
                </div>
            </div>

            <div ng-show="order.Approvals" class="panel panel-default approval-rule-status-summary">
                <div class="panel-heading">
                    <h3 class="panel-title panel-primary">Approvals</h3>
                </div>
                <div class="panel-body">
                    <approval ng-show="order.Status == 'AwaitingApproval' && (order.UserCanApprove || user.Permissions.contains('ApproveAllOrders'))" order="order"/>
                    <approvalrulelist order="order" />
                </div>
            </div>
        </div>
    </div>
    <orderprint class="visible-print" />
</section>